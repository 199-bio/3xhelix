const siteContent = {
    geneTherapyAnalysis: {
        title: "Gene Therapy Starts With Analysis",
        intro: "The world's most extensive whole body analysis for illness and longevity.",
        list: [
            "Comprehensive tests analyzing over 850,000 CpG loci",
            "Epigenetic Biological Age (whole-body summary)",
            "Telomere Length Analysis",
            "Dunedin PACE (current rate of aging measurement)",
            "OMICm Age (developed with Harvard University)",
            "Extrinsic Epigenetic Age (immune system impact)",
            "Intrinsic Epigenetic Age (aging independent of immune system)",
            "Immune cell-type ratios",
            "CD4:CD8 ratio measurements",
            "Rare Disease Screening (15,000+ Conditions + EDS)",
            "Carrier Screening",
            "Cancer Risk",
            "Autoimmune Disorders",
            "Digestive Disorders & Gut Health",
            "Cardiovascular Health",
            "Brain Health",
            "Neurological Health",
            "Endocrine Health",
            "Medication & Drug Response",
            "Connective Tissue Disorders",
            "Musculoskeletal Health",
            "Respiratory Health",
            "Reproductive & Hormonal Health",
            "Skin Health",
            "Immune System Health",
            "Growth & Bone Health",
            "Nutritional & Metabolic Health",
            "Whole genomic sequencing",
            "Whole exon sequencing"
        ]
    },
    completeBodySystemsAnalysis: {
        title: "Complete Body Systems Analysis",
        list: [
            "Cardiovascular System",
            "Digestive System",
            "Integumentary System",
            "Endocrine System",
            "Immune System",
            "Lymphatic System",
            "Musculoskeletal System",
            "Neurological System",
            "Respiratory System",
            "Reproductive System",
            "Sensory System",
            "Urinary System"
        ]
    },
    diseaseGeneTherapies: {
        title: "Diseases We Can Help",
        list: [
            "Alazami Syndrome", "ALS", "Alzheimers Disease", "Adrenomyeloneuropathy (AMN)",
            "Angelmans Syndrome", "Asthma", "Autism", "Becker Muscular Dystrophy",
            "Beta Thalasemia", "Coronary Artery Disease", "Cardiomyopathy", "CHF",
            "Age Related Cognitive Decline", "COPD", "Chronic Renal Insufficiency",
            "Danon Disease", "Duchenne's Muscular Dystrophy", "Facioscapulohumeral Disease FSHD",
            "Frontotemporal Dementia", "Fibromyalgia", "Functional Neurologic Disorder",
            "Friedrichs Ataxia", "HFpEF", "Hyperlipidemia", "Hypertension",
            "Inclusion Body Myositis", "Interstitial/Idiopathic Pulmonary Fibroses",
            "Juvenile Inflammatory Arthritis", "Lipoprotein A",
            "Medium-chain acyl-CoA dehydrogenase (MCAD) or MCAAD", "Metabolic Syndrome",
            "Multi-Infarct Dementia", "Myotonic Dystrophy Type II", "NAFLD", "NASH",
            "Non-Cystic Fibrosis Bronchiectasis NCFB", "Neuropathic Pain Syndrome", "Obesity",
            "Osteoarthritis", "Parkinson's disease", "Peripheral Vascular Disease",
            "Pantothenate kinase-associated neurodegeneration - PKAN", "Pompe Disease",
            "Prader-Willi Syndrome", "Pre-Diabetes", "Protein S Deficiency", "Pulmonary Fibrosis",
            "Sarcopenia of Chronic Disease", "Scleroderma", "Systemic Lupus Erythematosus SLE",
            "SPAST - SPG4 Deficiency - Hereditary Spastic Paraplegia Type 4",
            "Spinal Muscular Atrophy", "Stargardt Disease", "Stroke", "Type II Diabetes",
            "Thymic Involution/Atrophy", "Vascular Dementia", "Visceral White Fat Burden",
            "White Matter Disease", "And more"
        ]
    },
    longevityGeneTherapies: {
        title: "Longevity Gene Therapies",
        list: [
            "hTERT", "Follistatin", "FGF21", "Klotho Alpha", "SIRT1", "PGC1A", "FOXO3", "VEGF", "And more"
        ]
    },
    oncologicAnalysisDiagnostics: {
        list: [
            "Cancer staging", "Cancer screening", "CT", "MRI", "PET", "Mammography", "Ultrasound"
        ]
    },
    oncologicAnalysisGenomic: {
        title: "Cancer Genomic Analysis",
        list: [
            "Next generation sequencing (NGS)", "Tumor DNA analysis", "Blood test screening",
            "Biopsy services", "Cancer phenotyping", "Cancer sensitivity testing", "Cancer RNA Analysis"
        ]
    },
    oncologicAnalysisTherapies: {
        list: [
            "Image guided microwave ablation", "Image guided cryoablation", "Image Guided Electroporesis",
            "Chemoembolization", "Intratumoral Immunotherapy", "Intratumoral Chemotherapy",
            "IV Immunotherapy", "Anti-Cancer gene therapy"
        ]
    },
    oncologicDiseases: {
        title: "Oncologic Diseases We Address",
        intro: "We custom build Precision Oncology Therapies. We provide a comprehensive oncologic analysis and therapy plan utilizing tumor ablation, immunotherapy, gene therapy for gene up regulation, gene therapy to reinstall tumor suppressors such as P53, PTEN, RB1 etc, and siRNA for gene silencing. We address the following cancers.",
        list: [
            "Breast Cancer", "Colon Cancer", "Non-Small Cell Lung Cancer", "Other lung Cancer",
            "Pancreatic Cancer", "Prostate Cancer", "Melanoma", "Hepatocellular Cancer",
            "Other Hepatic Tumors", "Ovarian Cancer", "Glioblastoma", "Glioma",
            "Non Seminomatous Germ Cell Cancer", "Oral Squamous Cell Carcinoma", "Spinal Cord Tumors",
            "Renal Cell Carcinoma", "Sarcoma", "Neuroendocrine Tumor", "And Others"
        ]
    },
    tissueRegenerativeTherapies: {
        title: "Tissue Regenerative Therapies",
        list: [
            "Hair Regeneration", "ACL/PCL tear", "Rotator Cuff Tear",
            "Hip Arthrosis/AVN/Labral Tear/Chondromalacia",
            "Shoulder Arthrosis/AVN/Labral Tear/Chondromalacia",
            "Knee Arthrosis/AVN/Meniscal Tear/Chondromalacia",
            "Ankle Arthrosis/AVN/Chondromalacia", "Elbow Arthrosis/AVN/Chondromalacia",
            "Hand Arthrosis/AVN/Chondromalacia", "Tendonitis/Tendinosis", "Muscle Tears",
            "Osteoporosis", "Sacroiliitis", "Spinal Disc Degeneration", "Wound Healing",
            "Burn Healing", "Scar Revision", "Anti-Aging Facials", "And more"
        ]
    },
    cellularSources: {
        title: "Cellular Sources",
        list: [
            "Mesenchymal Stem Cells (MSCs)",
            "MUSE Stem Cells (Multilineage Stress Enduring Stem Cells)",
            "Exosomes", "Peptides", "Growth Factors"
        ]
    },
    teamMembers: [
        { 
            name: 'Dr. Patrick E. Sewell MD', 
            title: 'CEO & Founder', 
            fullBio: `Dr. Patrick E. Sewell MD, CEO and Founder of Trippplehelix, is a distinguished physician and scientist with an extensive background in gene therapy, oncology, and regenerative medicine. Holding an MD from the University of Kansas and board certifications in Diagnostic Radiology, Interventional Radiology, and Age Management Medicine, Dr. Sewell combines clinical expertise with innovative research.

His career includes pioneering work in minimally invasive cancer treatments, such as image-guided tumor ablation, a technology he invented that later saved his own life. Dr. Sewell has also made significant contributions to gene therapy, developing advanced protocols for genetic disorders, cancer, and age-related conditions.

At Trippplehelix, he leads a multidisciplinary team dedicated to advancing medical science and providing cutting-edge therapies globally. Dr. Sewell's vision is to transform healthcare by harnessing the power of genetic science to address complex diseases and enhance human longevity. He is a respected speaker at international conferences and a published author, committed to educating both medical professionals and the public on the latest advancements in his field.`
        },
        { 
            name: 'Dr. Chiara C. MD', 
            title: 'Director European Operations and Regenerative Medicine', 
            fullBio: `Dr. Chiara is a renowned expert in regenerative medicine, aesthetics, and sports medicine, with a distinguished career dedicated to advancing these fields. He holds board certifications in Orthopedics and Traumatology, as well as Physical Medicine and Rehabilitation, providing a strong foundation for his comprehensive approach to patient care.

With decades of surgical experience, Dr. Chiara has dedicated the past twenty years to pioneering work in regenerative medicine. His early clinical innovations began with fibroblast transplantation, which progressed into the use of stem cell therapies—starting with autologous applications and later advancing to allogeneic techniques.

Dr. Chiara integrates cutting-edge treatments including bioidentical hormones, therapeutic peptides, exosomes, and intravenous medicine into his practice. He currently serves as Medical Director of Bioinst in San Marino. His private practice spans Milan, San Marino, and Belgrade.`
        },
        { 
            name: 'Dr. Joe Cleaver MD', 
            title: 'Director Klotho Longevity Science', 
            fullBio: `Dr. Joe Cleaver is a pioneering physician in regenerative medicine and anti-aging therapies based in Dallas, Texas. With three decades of clinical and research experience, he holds board certifications in internal medicine and longevity medicine, complemented by fellowship training in rheumatology and immunology.

At Paradigm Wellness Medical Group LLC, Dr. Cleaver delivers personalized healthcare that addresses the root causes of aging at the cellular level. His comprehensive approach integrates regenerative medicine, lifestyle interventions, and advanced diagnostics to optimize health and extend lifespan, with particular focus on telomere health, epigenetic age, senolytic therapies, stem cell health, and Klotho protein optimization.

Dr. Cleaver has developed several groundbreaking therapies, including KLOTHAMAX™, a proprietary formulation that optimizes Klotho protein levels critical for healthspan and longevity. He pioneered the 4D LYFT™ Stem Cell Facelift, an innovative non-surgical rejuvenation procedure, and established stem cell banking for longevity patients through the Cell Surgical Network™.

As an author, Dr. Cleaver's works include the Amazon bestseller "THE ANTIAGING POWER OF KLOTHO" and the co-authored "PEPTIDE HANDBOOK" with James Lavalle RPh, CCN. A respected authority in his field, he regularly speaks at national and international conferences, trains medical professionals, and conducts clinical research advancing integrative and functional healthcare.

His mission is to empower patients to take charge of their well-being through a holistic approach that combines cutting-edge biologic therapies with personalized lifestyle modifications, redefining the boundaries of medicine to help individuals live longer, healthier, and more fulfilling lives.

At Trippplehelix, Dr Cleaver Brings his Klotho knowledge and expertise as Director of Klotho Longevity Science.`
        },
        { 
            name: 'Dr. Oscar Guadarrama DVM', 
            title: 'Director Veterinary Research and Therapy', 
            fullBio: `Dr. Oscar Guadarrama is a distinguished veterinarian who has dedicated his career to advancing small animal medicine and surgery. As the General Director of Intermédica Veterinaria, he has established himself as a leader in the veterinary field.

Dr. Guadarrama currently serves as the Director of Veterinary Research and Therapy at Trippplehelix, where he leads innovative research initiatives and therapeutic developments.

He is particularly noted for his groundbreaking work in veterinary regenerative medicine. Dr. Guadarrama serves as the Medical Director of MEREVET Veterinary Regenerative Medicine, where he has developed innovative protocols for the application of Growth Factors and Stem Cells in veterinary treatments.

His expertise in regenerative therapies is widely recognized, making him an active member of the Latin American Stem Cell Society (SOLCEMA) and a founding member of the International Society of Regenerative Medicine. Dr. Guadarrama has also contributed significantly to the field as a member of the Association of Ozone Professionals A.C.

One of his notable achievements includes his contribution to the development of the veterinary version of the Madrid Declaration, an important document in the field of veterinary medicine.

Dr. Guadarrama frequently shares his knowledge as a speaker on topics related to Prolotherapy, the clinical application of platelet-rich growth factors, Regenerative Medicine, and Cell Therapy in dogs and cats. His presentations have helped educate fellow veterinarians about these cutting-edge treatments and their benefits for animal patients.

Through his clinical practice, research, and educational efforts, Dr. Oscar Guadarrama continues to advance the field of veterinary medicine, particularly in regenerative therapies that improve the quality of life for companion animals.`
        },
        { 
            name: 'Hashim Riaz', 
            title: 'Chief Operating Officer', 
            fullBio: `With over a decade of experience at the intersection of patient safety, healthcare logistics, and health technology, Hashim brings a deep operational expertise to their role as Chief Operating Officer at Trippplehelix. Having worked across both National and private healthcare sectors, they have led initiatives that enhanced patient safety protocols and optimized care delivery. Their career spans managing the distribution of medicines and medical devices, ensuring regulatory compliance and supply chain efficiency across diverse markets.

Prior to joining Trippplehelix, Hashim held senior roles in health-tech ventures focused on making healthcare more affordable and accessible. Their commitment to safety, innovation and excellence in healthcare operations positions them as a key driver of Trippplehelix's mission and growth.`
        }
    ],
    knowledgeItems: [
        { type: 'book', title: 'Gene Therapy Essentials', description: 'Design of AAV for gene therapy provides an overview of gene therapy technology in 2025. Available on Amazon.com', link: '#' }, // Replace # with actual Amazon link
        { type: 'book', title: 'Stronger, faster, smarter.....', description: 'Today what can trippplehelix science accomplish? Available on Amazon.com', link: '#' }, // Replace # with actual Amazon link
        { type: 'event', title: 'Dublin Longevity Summit', description: 'Come see Dr Patrick E Sewell MD lecture on the latest on gene therapy and longevity medicine in Dublin Ireland July 2-4, 2025.' },
        { type: 'event', title: 'Cannes France Longevity Conference', description: 'Come see Dr Patrick E. Sewell MD lecture on the latest on gene therapy and longevity medicine in Cannes France June 25 - 26, 2025.' },
        { type: 'video', title: 'The Gene Therapy Revolution', description: 'See Dr Patrick E. Sewell MD lecture at at Oxford University, United Kingdom', videoId: '0zWgyg28VLE', thumbnailUrl: 'assets/images/gene_therapy_revolution.jpg' },
        { type: 'video', title: 'Comprehensive Cancer Therapy', description: 'See Dr Patrick E. Sewell MD lecture on the latest in Cancer therapy', videoId: 'VNWV5BRQs6A', thumbnailUrl: 'assets/images/comprehensive_cancer_therapy.jpg' },
        { type: 'video', title: 'Dementia Gene Therapy', description: 'See Dr Patrick E. Sewell MD discuss Dementia Gene Therapy', videoId: 'i_FoZyxgLC0', thumbnailUrl: 'assets/images/dementia_gene_therapy.jpg' },
        { type: 'video', title: 'Minimally Invasive Cancer Therapy', description: 'See Dr Patrick E. Sewell MD discuss his own cancer treatment...', videoId: 'YZTQ5on5jmA', thumbnailUrl: 'assets/images/minimally_invasive_cancer_therapy.jpg' },
        { type: 'video', title: 'Klotho Therapy and Lionheart', description: 'See the opening of our Lionheart anti-aging klotho therapy center...', videoId: 'rW6b5nNhJCI', thumbnailUrl: 'assets/images/klotho_lionheart.jpg' }
    ]
};

document.addEventListener('DOMContentLoaded', () => {
    const currentYearSpan = document.getElementById('current-year');
    if (currentYearSpan) {
        currentYearSpan.textContent = new Date().getFullYear();
    }
    initParticleSystem();
    loadDynamicContent();
    smoothScroll();
    initScrollAnimations();
    initCookieConsent();

    const contactForm = document.getElementById('contact-form');
    if (contactForm) {
        contactForm.addEventListener('submit', handleContactFormSubmit);
    }
});

function populateList(containerElement, items, listTitle, introText) {
    if (!containerElement) return;

    let htmlContent = '';
    if (listTitle) {
        htmlContent += `<h4>${listTitle}</h4>`;
    }
    if (introText) {
        htmlContent += `<p class="list-intro">${introText}</p>`;
    }
    if (items && items.length > 0) {
        htmlContent += '<ul>';
        items.forEach(item => {
            htmlContent += `<li>${item}</li>`;
        });
        htmlContent += '</ul>';
    }
    containerElement.innerHTML = htmlContent;
}

function loadDynamicContent() {
    console.log('Loading dynamic content...');

    // Populate #gene-therapies > #analysis-power
    const analysisPowerContainer = document.querySelector('#analysis-power .details-container[data-source="gene-therapy-analysis"]');
    if (analysisPowerContainer) {
        populateList(analysisPowerContainer, siteContent.geneTherapyAnalysis.list, null, null); // Title and intro are already in HTML
        // Add Complete Body Systems Analysis as a sub-list
        const bodySystemsContainer = document.createElement('div');
        bodySystemsContainer.classList.add('details-subsection');
        analysisPowerContainer.appendChild(bodySystemsContainer);
        populateList(bodySystemsContainer, siteContent.completeBodySystemsAnalysis.list, siteContent.completeBodySystemsAnalysis.title);
    }

    // Populate #disease-gene-therapies
    const diseaseTherapiesContainer = document.querySelector('#disease-gene-therapies .details-container[data-source="disease-gene-therapies"]');
    populateList(diseaseTherapiesContainer, siteContent.diseaseGeneTherapies.list, siteContent.diseaseGeneTherapies.title);

    // Populate #longevity
    const longevityTherapiesContainer = document.querySelector('#longevity .details-container[data-source="longevity-gene-therapies"]');
    populateList(longevityTherapiesContainer, siteContent.longevityGeneTherapies.list, siteContent.longevityGeneTherapies.title);

    // Populate #oncology
    const oncologyAnalysisContainer = document.querySelector('#oncology-reimagined .details-container[data-source="oncology-analysis"]');
    if (oncologyAnalysisContainer) {
        // First add "Our Cancer diagnostics include:" intro
        const diagnosticsIntro = document.createElement('p');
        diagnosticsIntro.innerHTML = '<strong>Our Cancer diagnostics include:</strong>';
        oncologyAnalysisContainer.appendChild(diagnosticsIntro);
        
        populateList(oncologyAnalysisContainer, siteContent.oncologicAnalysisDiagnostics.list, null);
        
        const genomicContainer = document.createElement('div');
        genomicContainer.classList.add('details-subsection');
        oncologyAnalysisContainer.appendChild(genomicContainer);
        populateList(genomicContainer, siteContent.oncologicAnalysisGenomic.list, siteContent.oncologicAnalysisGenomic.title);
        
        // Add "Our cancer Therapies include the following:" intro
        const therapiesIntro = document.createElement('p');
        therapiesIntro.innerHTML = '<strong>Our cancer Therapies include the following:</strong>';
        oncologyAnalysisContainer.appendChild(therapiesIntro);
        
        const therapiesContainer = document.createElement('div');
        therapiesContainer.classList.add('details-subsection');
        oncologyAnalysisContainer.appendChild(therapiesContainer);
        populateList(therapiesContainer, siteContent.oncologicAnalysisTherapies.list, null);
    }
    const oncologicDiseasesContainer = document.querySelector('#oncology-reimagined .details-container[data-source="oncologic-diseases"]');
    populateList(oncologicDiseasesContainer, siteContent.oncologicDiseases.list, siteContent.oncologicDiseases.title, siteContent.oncologicDiseases.intro);
    
    // Populate #cell-therapies-section
    const tissueRegenerativeContainer = document.querySelector('#cell-therapies .details-container[data-source="tissue-regenerative-therapies"]');
    populateList(tissueRegenerativeContainer, siteContent.tissueRegenerativeTherapies.list, siteContent.tissueRegenerativeTherapies.title);
    const cellularSourcesContainer = document.querySelector('#cell-therapies .details-container[data-source="cellular-sources"]');
    populateList(cellularSourcesContainer, siteContent.cellularSources.list, siteContent.cellularSources.title);

    // Populate Team Members
    const teamGrid = document.querySelector('#architects-innovation .team-grid');
    if (teamGrid) {
        teamGrid.innerHTML = ''; // Clear placeholder
        siteContent.teamMembers.forEach((member, index) => {
            const memberCard = document.createElement('div');
            memberCard.classList.add('team-member-card', 'glass-card');
            
            // Create brief excerpt from bio
            const briefBio = member.fullBio.substring(0, 150) + '...';
            
            memberCard.innerHTML = `
                <div class="team-member-photo">
                    <img src="assets/images/team-member-${index + 1}.jpg" alt="${member.name}" onerror="this.style.display='none'; this.parentElement.classList.add('no-photo')">
                </div>
                <h3>${member.name}</h3>
                <p class="title">${member.title}</p>
                <p class="bio-excerpt">${briefBio}</p>
                <button class="read-bio-btn" onclick="toggleBio(${index})">Read Full Bio</button>
                <div class="bio-full-container" id="bio-${index}" style="display: none;">
                    <p class="bio-full">${member.fullBio}</p>
                </div>
            `;
            teamGrid.appendChild(memberCard);
        });
    }

    // Populate Knowledge Items
    const knowledgeGrid = document.querySelector('#sharing-knowledge .knowledge-grid');
    if (knowledgeGrid) {
        knowledgeGrid.innerHTML = ''; // Clear placeholder
        siteContent.knowledgeItems.forEach(item => {
            const knowledgeCard = document.createElement('div');
            knowledgeCard.classList.add('knowledge-item-card', 'glass-card');
            let content = `<h3>${item.title}</h3><p>${item.description}</p>`;
            if (item.type === 'video') {
                content += `<div class="video-thumbnail-container"><img src="${item.thumbnailUrl}" alt="${item.title}" class="video-thumbnail"><div class="play-button-overlay">▶</div></div>`;
                knowledgeCard.addEventListener('click', () => {
                    // Open YouTube video in a modal or new tab
                    window.open(`https://www.youtube.com/watch?v=${item.videoId}`, '_blank');
                });
            } else if (item.type === 'book' && item.link) {
                content += `<a href="${item.link}" target="_blank" class="cta-button small-cta">View on Amazon</a>`;
            } else if (item.type === 'event') {
                // Just text for event
            }
            knowledgeCard.innerHTML = content;
            knowledgeGrid.appendChild(knowledgeCard);
        });
    }
}

function initParticleSystem() {
    const particleContainer = document.getElementById('particle-container');
    if (!particleContainer) return;

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    particleContainer.appendChild(canvas);

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    const particleCount = Math.min(50, Math.floor(canvas.width / 30)); // Adjust particle count based on width

    class Particle {
        constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.size = Math.random() * 1.5 + 0.3; // Smaller, more subtle particles
            this.speedX = (Math.random() * 0.4 - 0.2) * 0.5; // Slower movement
            this.speedY = (Math.random() * 0.4 - 0.2) * 0.5;
            this.color = 'rgba(196, 162, 110, 0.3)'; // Softer Gold accent (var(--light-gold-accent) with alpha)
        }

        update() {
            this.x += this.speedX;
            this.y += this.speedY;

            // More gradual size reduction or just fade out
            if (this.size > 0.05) this.size -= 0.003;

            if (this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height || this.size <= 0.05) {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 1.5 + 0.3;
                this.speedX = (Math.random() * 0.4 - 0.2) * 0.5;
                this.speedY = (Math.random() * 0.4 - 0.2) * 0.5;
            }
        }

        draw() {
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
        }
    }

    function initParticles() {
        particles = [];
        for (let i = 0; i < particleCount; i++) {
            particles.push(new Particle());
        }
    }

    function animateParticles() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < particles.length; i++) {
            particles[i].update();
            particles[i].draw();
        }
        requestAnimationFrame(animateParticles);
    }

    initParticles();
    animateParticles();

    // Debounce resize handler
    let resizeTimeout;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            initParticles(); // Re-initialize particles for new canvas size
        }, 250);
    });
}

function smoothScroll() {
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                targetElement.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        });
    });
}

function initScrollAnimations() {
    const sections = document.querySelectorAll('main section');
    const options = {
        root: null,
        threshold: 0.15, // Trigger a bit earlier/later
        rootMargin: "0px 0px -50px 0px" // Adjust margin to trigger sooner when scrolling down
    };

    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
            } else {
                // Optional: remove class if you want animation to replay on scroll up
                // entry.target.classList.remove('visible'); 
            }
        });
    }, options);

    sections.forEach(section => {
        observer.observe(section);
    });
}

async function handleContactFormSubmit(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());

    if (!data.email || !data.message) {
        alert('Please fill in all fields.');
        return;
    }

    console.log('Form data:', data);
    // In a real scenario, you'd POST this to a serverless function or service (e.g., Vercel Edge Functions, Formspree)
    // For Vercel, you could create an /api/contact.js endpoint.
    
    // Simulate API call success
    form.reset();
    const submitButton = form.querySelector('button[type="submit"]');
    const originalButtonText = submitButton.textContent;
    submitButton.textContent = 'Sent!';
    submitButton.disabled = true;

    setTimeout(() => {
        submitButton.textContent = originalButtonText;
        submitButton.disabled = false;
    }, 3000);
}

function initCookieConsent() {
    const cookieBanner = document.getElementById('cookie-banner');
    const acceptButton = document.getElementById('accept-cookies');
    
    if (!cookieBanner || !acceptButton) return;
    
    // Check if cookies have been accepted
    const cookiesAccepted = localStorage.getItem('cookiesAccepted');
    
    if (!cookiesAccepted) {
        // Show the banner after a small delay
        setTimeout(() => {
            cookieBanner.classList.add('show');
        }, 1000);
    }
    
    // Handle accept button click
    acceptButton.addEventListener('click', () => {
        localStorage.setItem('cookiesAccepted', 'true');
        cookieBanner.classList.remove('show');
        
        // Hide completely after transition
        setTimeout(() => {
            cookieBanner.style.display = 'none';
        }, 300);
    });
}

// Toggle bio visibility
function toggleBio(index) {
    const bioContainer = document.getElementById(`bio-${index}`);
    const button = event.target;
    
    if (bioContainer.style.display === 'none') {
        bioContainer.style.display = 'block';
        button.textContent = 'Close Bio';
        // Smooth scroll to make sure bio is visible
        setTimeout(() => {
            bioContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
    } else {
        bioContainer.style.display = 'none';
        button.textContent = 'Read Full Bio';
    }
} 